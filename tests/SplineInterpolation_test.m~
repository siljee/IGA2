close all; addpath ../; addpath ../Basis/; addpath ../HelpFunctions/
a = -1; b = 1;
el = 5; p = 3;

%func = @(x) (x).^3;
func = @(x) sin(x*2*pi);

x_para = linspace(0,1,100);
x_phys = x_para*(b-a)+a;

knotVec = makeUniformKnotVector(p,el);
greville_para = findGrevillePoints(knotVec,p);
greville_phys = greville_para*(b-a) + a;

N = BsplineBasis(knotVec,p,x_para);
y_phys = func(x_phys);

d = N'\y_phys';


figure(1)
hold on 

% The exact function
plot(x_phys,func(x_phys),'--k')

% The points 
plot(greville_phys,d,'-*')

% The interpolated solution
plot(x_phys,N'*d,'r-')
gedit

% Verification
norm(func(x_phys)'-N'*d)


%%%%%%%%%%%%%%%%%%%%%%%%%%%% TEst av andre punkter %%%%%%%%%%%%%%%%%